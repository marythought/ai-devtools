{% extends 'todos/base.html' %}
{% load i18n %}

{% block title %}{% trans "Create TODO" %}{% endblock %}

{% block content %}
    <h1>{% trans "Create New TODO" %}</h1>

    {% if not perms.auth.can_modify_todos %}
        <div style="padding: 15px; background-color: #fff3cd; border: 1px solid #ffc107; border-radius: 4px; margin-top: 20px;">
            <p style="margin: 0; color: #856404;"><strong>{% trans "Demo Mode:" %}</strong> {% trans "You cannot create new todos. You can mark existing todos complete/incomplete and reorder them." %}</p>
            <a href="{% url 'todo_list' %}" class="btn" style="margin-top: 10px; display: inline-block;">{% trans "Back to Todo List" %}</a>
        </div>
    {% else %}
    <form method="post" style="margin-top: 20px;">
        {% csrf_token %}
        <div style="margin-bottom: 20px;">
            <label for="title" style="display: block; margin-bottom: 8px; font-weight: 500;">{% trans "Title" %} *</label>
            <input type="text" id="title" name="title" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
        </div>
        <div style="margin-bottom: 20px;">
            <label for="description" style="display: block; margin-bottom: 8px; font-weight: 500;">{% trans "Description" %}</label>
            <textarea id="description" name="description" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; font-family: inherit;"></textarea>
        </div>
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 500;">{% trans "Due Date" %}</label>
            <div style="display: flex; gap: 10px;">
                <input type="date" id="due_date_date" name="due_date_date" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                <select id="due_date_hour" name="due_date_hour" style="padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                    <option value="">{% trans "Hour (optional)" %}</option>
                    <option value="00">12 AM</option>
                    <option value="01">1 AM</option>
                    <option value="02">2 AM</option>
                    <option value="03">3 AM</option>
                    <option value="04">4 AM</option>
                    <option value="05">5 AM</option>
                    <option value="06">6 AM</option>
                    <option value="07">7 AM</option>
                    <option value="08">8 AM</option>
                    <option value="09">9 AM</option>
                    <option value="10">10 AM</option>
                    <option value="11">11 AM</option>
                    <option value="12">12 PM</option>
                    <option value="13">1 PM</option>
                    <option value="14">2 PM</option>
                    <option value="15">3 PM</option>
                    <option value="16">4 PM</option>
                    <option value="17">5 PM</option>
                    <option value="18">6 PM</option>
                    <option value="19">7 PM</option>
                    <option value="20">8 PM</option>
                    <option value="21">9 PM</option>
                    <option value="22">10 PM</option>
                    <option value="23">11 PM</option>
                </select>
            </div>
        </div>
        <div style="margin-bottom: 20px;">
            <label for="effort" style="display: block; margin-bottom: 8px; font-weight: 500;">{% trans "Perceived Effort Level (Spoons)" %} ðŸ¥„</label>
            <input type="number" id="effort" name="effort" value="0" min="0" max="10" style="width: 100px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
            <small style="display: block; color: #666; margin-top: 4px;">{% trans "0 (none) to 10 (maximum effort)" %}</small>
        </div>
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 500;">{% trans "Categories" %}</label>
            {% if categories %}
                {% for category in categories %}
                    <div style="margin-bottom: 5px;">
                        <label style="display: inline-flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" name="categories" value="{{ category.id }}" {% if category.id in preselected_category_ids %}checked{% endif %} style="margin-right: 8px;">
                            <span>{{ category.name }}</span>
                        </label>
                    </div>
                {% endfor %}
            {% else %}
                <p style="color: #999; font-size: 14px; font-style: italic;">{% trans "No categories yet." %} <a href="{% url 'manage_categories' %}" style="color: #007bff;">{% trans "Create one now!" %}</a></p>
            {% endif %}
        </div>
        <div style="display: flex; gap: 10px;">
            <button type="submit" class="btn">{% trans "Create TODO" %}</button>
            <a href="{% url 'todo_list' %}" class="btn" style="background-color: #6c757d;">{% trans "Cancel" %}</a>
        </div>
    </form>
    {% endif %}
{% endblock %}
